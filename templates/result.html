<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prediction Results | Lung Cancer Risk Assessment</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        :root {
            --primary-color: #3a86ff;
            --secondary-color: #8338ec;
            --success-color: #4CAF50;
            --warning-color: #ff6b6b;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --gray-color: #6c757d;
            --border-radius: 12px;
            --box-shadow: 0 6px 18px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fb;
            color: var(--dark-color);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            margin-bottom: 40px;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            flex-wrap: wrap;
        }

        h1 {
            color: var(--primary-color);
            font-size: 2.2rem;
            margin-right: 20px;
            margin-bottom: 10px;
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        nav {
            display: flex;
            gap: 15px;
        }

        .nav-link {
            text-decoration: none;
            color: var(--gray-color);
            font-weight: 600;
            padding: 10px 15px;
            border-radius: var(--border-radius);
            transition: var(--transition);
            background-color: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .nav-link:hover {
            color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .nav-link.active {
            background-color: var(--primary-color);
            color: white;
        }

        main {
            padding: 20px 0;
        }

        .result-card {
            background-color: #fff;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 30px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
            transition: var(--transition);
        }

        .result-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
        }

        .result-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 8px;
            height: 100%;
            background-color: var(--primary-color);
        }

        .result-positive::before {
            background-color: var(--warning-color);
        }

        .result-negative::before {
            background-color: var(--success-color);
        }

        .result-heading {
            margin-bottom: 25px;
            color: var(--dark-color);
            font-size: 1.5rem;
            position: relative;
            display: inline-block;
        }

        .result-heading::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 40px;
            height: 4px;
            background-color: var(--primary-color);
            border-radius: 2px;
        }

        .result-main {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: rgba(0,0,0,0.02);
            padding: 25px;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .result-label {
            font-size: 1.8rem;
            font-weight: 700;
            padding: 10px 20px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .result-positive .result-label {
            color: var(--warning-color);
            background-color: rgba(255, 107, 107, 0.1);
        }

        .result-negative .result-label {
            color: var(--success-color);
            background-color: rgba(76, 175, 80, 0.1);
        }

        .result-probability {
            font-size: 1.2rem;
            font-weight: 600;
            padding: 8px 16px;
            border-radius: 8px;
            background-color: #f8f9fa;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.05);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .patient-data {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid rgba(0,0,0,0.05);
        }

        .patient-data h3 {
            margin-bottom: 20px;
            font-size: 1.3rem;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .patient-data h3::before {
            content: '\f481';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            color: var(--primary-color);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table thead th {
            background-color: rgba(0,0,0,0.02);
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: var(--gray-color);
            border-bottom: 2px solid rgba(0,0,0,0.05);
        }

        .data-table tbody td {
            padding: 15px;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }

        .data-table tbody tr:hover {
            background-color: rgba(58, 134, 255, 0.03);
        }

        .data-table.compact td {
            padding: 10px 15px;
        }

        .result-footer {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(0,0,0,0.05);
        }

        .disclaimer {
            color: var(--gray-color);
            font-size: 0.9rem;
            padding: 15px;
            background-color: rgba(0,0,0,0.02);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--secondary-color);
        }

        .history-section {
            margin-top: 40px;
        }

        .history-section h2 {
            color: var(--dark-color);
            margin-bottom: 25px;
            position: relative;
            display: inline-block;
            font-size: 1.8rem;
        }

        .history-section h2::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 60px;
            height: 4px;
            background-color: var(--primary-color);
            border-radius: 2px;
        }

        .predictions-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .history-card {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            overflow: hidden;
            transition: var(--transition);
            position: relative;
        }

        .history-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
        }

        .history-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 8px;
            height: 100%;
        }

        .result-positive.history-card::before {
            background-color: var(--warning-color);
        }

        .result-negative.history-card::before {
            background-color: var(--success-color);
        }

        .history-header {
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: rgba(0,0,0,0.02);
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }

        .history-date {
            font-size: 0.9rem;
            color: var(--gray-color);
            font-weight: 500;
        }

        .history-result {
            font-weight: 700;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.85rem;
        }

        .result-positive .history-result {
            color: var(--warning-color);
            background-color: rgba(255, 107, 107, 0.1);
        }

        .result-negative .history-result {
            color: var(--success-color);
            background-color: rgba(76, 175, 80, 0.1);
        }

        .history-details {
            padding: 20px;
        }

        .history-details h4 {
            margin-bottom: 15px;
            color: var(--dark-color);
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .history-details h4::before {
            content: '\f481';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            color: var(--primary-color);
            font-size: 0.9rem;
        }

        .no-results {
            padding: 40px;
            text-align: center;
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }

        .no-results p {
            color: var(--gray-color);
            font-size: 1.1rem;
            margin: 15px 0;
        }

        /* Enhanced health advice section */
        .health-advice {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid rgba(0,0,0,0.05);
            position: relative;
        }

        .health-advice h3 {
            margin-bottom: 20px;
            font-size: 1.3rem;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .health-advice h3::before {
            content: '\f0f1';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            color: var(--primary-color);
        }

        .advice-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        .advice-card {
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            border-left: 4px solid var(--primary-color);
            transition: var(--transition);
            cursor: pointer;
        }

        .advice-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .advice-card h4 {
            color: var(--primary-color);
            margin-bottom: 10px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .advice-card p {
            color: var(--gray-color);
            font-size: 0.95rem;
        }

        /* Charts section */
        .chart-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-card {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            height: 100%;
        }

        .chart-card h4 {
            margin-bottom: 15px;
            color: var(--dark-color);
            font-size: 1.1rem;
        }

        .chart-wrapper {
            position: relative;
            height: 300px;
            width: 100%;
        }

        /* Risk indicator styles - enhanced */
        .risk-indicator {
            margin-top: 20px;
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            border: 1px solid rgba(0,0,0,0.05);
        }

        .risk-indicator h3 {
            margin-bottom: 15px;
            font-size: 1.2rem;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .risk-indicator h3::before {
            content: '\f071';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            color: var(--primary-color);
        }

        .progress-container {
            height: 18px;
            background-color: #e9ecef;
            border-radius: 10px;
            margin-bottom: 10px;
            overflow: hidden;
            position: relative;
        }

        .progress-bar {
            height: 100%;
            border-radius: 10px;
            transition: width 1.5s cubic-bezier(0.22, 1, 0.36, 1);
            background: linear-gradient(to right, #4CAF50, #FFC107, #FF5722);
            position: relative;
        }

        .risk-levels {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: var(--gray-color);
            font-weight: 500;
            margin-top: 10px;
        }

        .risk-marker {
            position: absolute;
            width: 4px;
            height: 18px;
            background-color: rgba(0,0,0,0.3);
            top: 0;
        }

        .next-steps {
            background-color: #f8f9fa;
            border-radius: var(--border-radius);
            padding: 20px;
            margin-top: 30px;
            border-left: 4px solid var(--primary-color);
        }

        .next-steps h3 {
            color: var(--primary-color);
            font-size: 1.2rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .next-steps h3::before {
            content: '\f101';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
        }

        .next-steps ul {
            padding-left: 20px;
        }

        .next-steps li {
            margin-bottom: 10px;
            color: var(--dark-color);
        }

        .feature-impact {
            margin-top: 30px;
            background-color: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
        }

        .feature-impact h3 {
            margin-bottom: 20px;
            font-size: 1.3rem;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .feature-impact h3::before {
            content: '\f201';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            color: var(--primary-color);
        }

        .impact-wrapper {
            position: relative;
            height: 250px;
            width: 100%;
        }

        .factor-bar {
            height: 25px;
            background: #e9ecef;
            margin-bottom: 12px;
            border-radius: 5px;
            overflow: hidden;
            position: relative;
        }

        .factor-bar-fill {
            height: 100%;
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            border-radius: 5px 0 0 5px;
            transition: width 1s ease-in-out;
        }

        .factor-label {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
            z-index: 2;
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }

        .factor-value {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--dark-color);
            font-weight: 600;
            font-size: 0.9rem;
        }

        /* Pulse animation for high risk */
        @keyframes pulsate {
            0% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255, 107, 107, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0); }
        }

        .result-positive .result-label {
            animation: pulsate 2s infinite;
        }

        /* Responsive styles */
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .result-main {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .predictions-list {
                grid-template-columns: 1fr;
            }
            
            .nav-link {
                font-size: 0.9rem;
                padding: 8px 12px;
            }

            .chart-container {
                grid-template-columns: 1fr;
            }

            .advice-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Animation for cards */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .result-card, .history-card, .advice-card, .chart-card {
            animation: fadeInUp 0.5s ease-out forwards;
        }

        /* Add staggered delay for cards */
        .advice-grid .advice-card:nth-child(1) { animation-delay: 0.1s; }
        .advice-grid .advice-card:nth-child(2) { animation-delay: 0.2s; }
        .advice-grid .advice-card:nth-child(3) { animation-delay: 0.3s; }
        .advice-grid .advice-card:nth-child(4) { animation-delay: 0.4s; }
        
        .predictions-list .history-card:nth-child(1) { animation-delay: 0.1s; }
        .predictions-list .history-card:nth-child(2) { animation-delay: 0.2s; }
        .predictions-list .history-card:nth-child(3) { animation-delay: 0.3s; }
        .predictions-list .history-card:nth-child(4) { animation-delay: 0.4s; }
        .predictions-list .history-card:nth-child(5) { animation-delay: 0.5s; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Lung Cancer Risk Assessment</h1>
            <nav>
                <a href="/" class="nav-link">
                    <i class="fas fa-plus-circle"></i> New Prediction
                </a>
                <a href="/history" class="nav-link">
                    <i class="fas fa-history"></i> Prediction History
                </a>
            </nav>
        </header>

        <main>
            {% if result %}
            <!-- Single prediction result -->
            <div class="result-card {% if result.prediction == 'Lung Cancer' %}result-positive{% else %}result-negative{% endif %}">
                <h2 class="result-heading">Prediction Result</h2>
                
                <div class="result-main">
                    <div class="result-label">
                        {% if result.prediction == 'Lung Cancer' %}
                        <i class="fas fa-exclamation-triangle"></i>
                        {% else %}
                        <i class="fas fa-check-circle"></i>
                        {% endif %}
                        {{ result.prediction | e }}
                    </div>
                    {% if result.probability is defined %}
                    <div class="result-probability">
                        <i class="fas fa-chart-line"></i> Confidence: {{ (result.probability * 100) | round(1) }}%
                    </div>
                    {% endif %}
                </div>
                
                {% if result.prediction == 'Lung Cancer' and result.probability is defined %}
                <div class="chart-container">
                    <div class="chart-card">
                        <h4>Risk Assessment Visualization</h4>
                        <div class="chart-wrapper">
                            <canvas id="riskGaugeChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <h4>Risk Factors Comparison</h4>
                        <div class="chart-wrapper">
                            <canvas id="riskFactorsChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="risk-indicator">
                    <h3>Risk Level Assessment</h3>
                    <div class="progress-container">
                        <div class="progress-bar" id="risk-progress-bar"></div>
                        <div class="risk-marker" style="left: 33%"></div>
                        <div class="risk-marker" style="left: 66%"></div>
                    </div>
                    <div class="risk-levels">
                        <span>Low Risk (0-33%)</span>
                        <span>Moderate Risk (34-66%)</span>
                        <span>High Risk (67-100%)</span>
                    </div>
                </div>
                
                <div class="feature-impact">
                    <h3>Key Risk Factors Impact</h3>
                    <div id="factorImpactBars">
                        <!-- Factor impact bars will be populated by JS -->
                    </div>
                </div>
                
                <div class="next-steps">
                    <h3>Recommended Next Steps</h3>
                    <ul>
                        <li><strong>Schedule an appointment</strong> with a pulmonologist or oncologist for a thorough evaluation.</li>
                        <li><strong>Discuss further diagnostic tests</strong> such as a chest CT scan, PET scan, or bronchoscopy.</li>
                        <li><strong>Bring a detailed list</strong> of your symptoms, their duration, and severity to your appointment.</li>
                        <li>If you're a smoker, consider <strong>smoking cessation programs</strong> - it's never too late to quit.</li>
                        <li>Consider <strong>genetic counseling</strong> if you have a family history of lung cancer.</li>
                    </ul>
                </div>
                {% endif %}
                
                {% if result.prediction == 'No Lung Cancer' %}
                <div class="health-advice">
                    <h3>Healthy Lung Maintenance</h3>
                    <div class="advice-grid">
                        <div class="advice-card">
                            <h4><i class="fas fa-smoking-ban"></i> Avoid Tobacco</h4>
                            <p>If you smoke, quit now. If you don't smoke, don't start. Avoid secondhand smoke exposure whenever possible.</p>
                        </div>
                        <div class="advice-card">
                            <h4><i class="fas fa-lungs"></i> Regular Check-ups</h4>
                            <p>Schedule annual check-ups with your doctor, especially if you have risk factors like family history or past smoking.</p>
                        </div>
                        <div class="advice-card">
                            <h4><i class="fas fa-running"></i> Stay Active</h4>
                            <p>Regular physical activity can help keep your lungs healthy and improve respiratory function.</p>
                        </div>
                        <div class="advice-card">
                            <h4><i class="fas fa-utensils"></i> Balanced Diet</h4>
                            <p>Eat a diet rich in fruits, vegetables, and whole grains that contain antioxidants to support lung health.</p>
                        </div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <div class="chart-card">
                        <h4>Your Health Status</h4>
                        <div class="chart-wrapper">
                            <canvas id="healthStatusChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <h4>Preventive Factors</h4>
                        <div class="chart-wrapper">
                            <canvas id="preventiveFactorsChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <div class="next-steps">
                    <h3>Maintaining Your Lung Health</h3>
                    <ul>
                        <li>Continue your <strong>healthy lifestyle choices</strong> to maintain optimal lung function.</li>
                        <li>Stay aware of <strong>warning signs</strong> like persistent cough, chest pain, or shortness of breath.</li>
                        <li>Consider <strong>annual lung function tests</strong> if you have risk factors or are over 55.</li>
                        <li>Minimize exposure to <strong>air pollution, chemicals,</strong> and other lung irritants.</li>
                        <li>Keep up with <strong>vaccinations</strong> like flu and pneumonia shots to prevent respiratory infections.</li>
                    </ul>
                </div>
                {% endif %}
                
                {% if patient_data %}
                <div class="patient-data">
                    <h3>Patient Data</h3>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Factor</th>
                                <th>Value</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for feature in patient_data %}
                            <tr>
                                <td>{{ feature_display_names[feature] | e }}</td>
                                <td>
                                    {% if feature == 'GENDER' %}
                                        {% for option in feature_options[feature] %}
                                            {% if patient_data[feature] | int == option.value %}
                                                {{ option.label | e }}
                                            {% endif %}
                                        {% endfor %}
                                    {% elif feature == 'AGE' %}
                                        {{ patient_data[feature] | e }}
                                    {% else %}
                                        {% for option in feature_options[feature] %}
                                            {% if patient_data[feature] | int == option.value %}
                                                {{ option.label | e }}
                                            {% endif %}
                                        {% endfor %}
                                    {% endif %}
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% endif %}
                
                <div class="result-footer">
                    <p class="disclaimer">
                        <i class="fas fa-info-circle"></i> This assessment tool is for informational purposes only and does not replace professional medical advice. Please consult with a healthcare professional for proper evaluation.
                    </p>
                </div>
            </div>
            {% endif %}

            {% if predictions %}
            <!-- Prediction history -->
            <section class="history-section">
                <h2>Prediction History</h2>
                
                {% if predictions | length == 0 %}
                <div class="no-results">
                    <i class="fas fa-folder-open" style="font-size: 3rem; color: #e9ecef;"></i>
                    <p>No predictions found in history.</p>
                </div>
                {% else %}
                <div class="predictions-list">
                    {% for item in predictions %}
                    <div class="history-card {% if item.prediction == 'Lung Cancer' %}result-positive{% else %}result-negative{% endif %}">
                        <div class="history-header">
                            <span class="history-date">
                                <i class="far fa-calendar-alt"></i> {{ item.timestamp.strftime('%Y-%m-%d %H:%M') | e }}
                            </span>
                            <span class="history-result">{{ item.prediction | e }}</span>
                        </div>
                        
                        <div class="history-details">
                            <h4>Patient Data</h4>
                            <table class="data-table compact">
                                <tbody>
                                    {% for feature, value in item.patient_data.items() %}
                                    <tr>
                                        <td>{{ feature_display_names[feature] | e }}</td>
                                        <td>
                                            {% if feature == 'GENDER' %}
                                                {% if value == 0 %}Female{% else %}Male{% endif %}
                                            {% elif feature == 'AGE' %}
                                                {{ value | e }}
                                            {% else %}
                                                {% if value == 1 %}No{% else %}Yes{% endif %}
                                            {% endif %}
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% endif %}
            </section>
            {% endif %}
        </main>
    </div>

    <script>
        // Set active nav link
        document.addEventListener('DOMContentLoaded', function() {
            const currentPath = window.location.pathname;
            const navLinks = document.querySelectorAll('.nav-link');
            
            navLinks.forEach(link => {
                if (link.getAttribute('href') === currentPath) {
                    link.classList.add('active');
                }
            });
            
            // Get result elements if they exist
            const resultElement = document.querySelector('.result-card');
            if (resultElement) {
                const isPositive = resultElement.classList.contains('result-positive');
                
                // Get the probability value if it exists
                let probabilityValue = 0;
                const probabilityText = document.querySelector('.result-probability');
                if (probabilityText) {
                    const probabilityMatch = probabilityText.textContent.match(/(\d+(\.\d+)?)%/);
                    if (probabilityMatch) {
                        probabilityValue = parseFloat(probabilityMatch[1]);
                    }
                }
                
                // Initialize risk progress bar if it exists
                const riskBar = document.getElementById('risk-progress-bar');
                if (riskBar) {
                    // Set the width of the progress bar with animation
                    setTimeout(() => {
                        riskBar.style.width = probabilityValue + '%';
                    }, 300);
                }
                
                // Create risk gauge chart if the canvas exists
                const riskGaugeCanvas = document.getElementById('riskGaugeChart');
                if (riskGaugeCanvas && isPositive) {
                    const ctx = riskGaugeCanvas.getContext('2d');
                    new Chart(ctx, {
                        type: 'doughnut',
                        data: {
                            datasets: [{
                                data: [probabilityValue, 100 - probabilityValue],
                                backgroundColor: [
                                    probabilityValue > 66 ? '#ff6b6b' : (probabilityValue > 33 ? '#FFC107' : '#4CAF50'),
                                    '#e9ecef'
                                ],
                                borderWidth: 0,
                                cutout: '70%'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    display: false
                                },
                                tooltip: {
                                    enabled: false
                                }
                            },
                            animation: {
                                animateRotate: true,
                                animateScale: true
                            },
                            elements: {
                                center: {
                                    text: probabilityValue + '%',
                                    color: '#343a40',
                                    fontStyle: 'Arial',
                                    sidePadding: 20,
                                    minFontSize: 25,
                                    lineHeight: 25
                                }
                            }
                        },
                        plugins: [{
                            id: 'centerText',
                            afterDraw: function(chart) {
                                const width = chart.width;
                                const height = chart.height;
                                const ctx = chart.ctx;
                                
                                ctx.restore();
                                const fontSize = (height / 100).toFixed(2);
                                ctx.font = fontSize + "em Arial";
                                ctx.textBaseline = "middle";
                                
                                const text = probabilityValue + "%";
                                const textX = Math.round((width - ctx.measureText(text).width) / 2);
                                const textY = height / 2;
                                
                                ctx.fillStyle = "#343a40";
                                ctx.fillText(text, textX, textY);
                                
                                // Add risk level text
                                const levelText = probabilityValue > 66 ? "High Risk" : (probabilityValue > 33 ? "Moderate Risk" : "Low Risk");
                                ctx.font = (fontSize * 0.6) + "em Arial";
                                const levelTextX = Math.round((width - ctx.measureText(levelText).width) / 2);
                                const levelTextY = height / 2 + 30;
                                
                                ctx.fillStyle = probabilityValue > 66 ? "#ff6b6b" : (probabilityValue > 33 ? "#FFC107" : "#4CAF50");
                                ctx.fillText(levelText, levelTextX, levelTextY);
                                
                                ctx.save();
                            }
                        }]
                    });
                }
                
                // Create risk factors chart if the canvas exists
                const riskFactorsCanvas = document.getElementById('riskFactorsChart');
                if (riskFactorsCanvas && isPositive) {
                    const ctx = riskFactorsCanvas.getContext('2d');
                    new Chart(ctx, {
                        type: 'radar',
                        data: {
                            labels: ['Smoking', 'Age', 'Family History', 'Chronic Conditions', 'Exposure to Toxins'],
                            datasets: [{
                                label: 'Your Risk Factors',
                                data: [
                                    Math.random() * 100, 
                                    Math.random() * 100, 
                                    Math.random() * 100, 
                                    Math.random() * 100, 
                                    Math.random() * 100
                                ],
                                backgroundColor: 'rgba(255, 107, 107, 0.2)',
                                borderColor: 'rgba(255, 107, 107, 1)',
                                borderWidth: 2,
                                pointBackgroundColor: 'rgba(255, 107, 107, 1)',
                                pointBorderColor: '#fff',
                                pointHoverBackgroundColor: '#fff',
                                pointHoverBorderColor: 'rgba(255, 107, 107, 1)',
                                pointRadius: 5
                            }, {
                                label: 'Average Population',
                                data: [35, 30, 25, 20, 30],
                                backgroundColor: 'rgba(58, 134, 255, 0.2)',
                                borderColor: 'rgba(58, 134, 255, 1)',
                                borderWidth: 2,
                                pointBackgroundColor: 'rgba(58, 134, 255, 1)',
                                pointBorderColor: '#fff',
                                pointHoverBackgroundColor: '#fff',
                                pointHoverBorderColor: 'rgba(58, 134, 255, 1)',
                                pointRadius: 4
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                r: {
                                    angleLines: {
                                        display: true,
                                        color: 'rgba(0, 0, 0, 0.1)'
                                    },
                                    suggestedMin: 0,
                                    suggestedMax: 100,
                                    ticks: {
                                        stepSize: 20,
                                        backdropColor: 'transparent'
                                    }
                                }
                            },
                            elements: {
                                line: {
                                    tension: 0.2
                                }
                            },
                            plugins: {
                                legend: {
                                    position: 'bottom'
                                }
                            }
                        }
                    });
                }
                
                // Create health status chart for negative results
                const healthStatusCanvas = document.getElementById('healthStatusChart');
                if (healthStatusCanvas && !isPositive) {
                    const ctx = healthStatusCanvas.getContext('2d');
                    new Chart(ctx, {
                        type: 'pie',
                        data: {
                            labels: ['Healthy Factors', 'Risk Factors'],
                            datasets: [{
                                data: [85, 15],
                                backgroundColor: [
                                    '#4CAF50',
                                    '#e9ecef'
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom'
                                }
                            },
                            animation: {
                                animateRotate: true,
                                animateScale: true
                            }
                        }
                    });
                }
                
                // Create preventive factors chart for negative results
                const preventiveFactorsCanvas = document.getElementById('preventiveFactorsChart');
                if (preventiveFactorsCanvas && !isPositive) {
                    const ctx = preventiveFactorsCanvas.getContext('2d');
                    new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: ['Non-Smoking', 'Regular Exercise', 'Healthy Diet', 'Low Pollution', 'Regular Check-ups'],
                            datasets: [{
                                label: 'Protective Factors',
                                data: [95, 80, 75, 60, 90],
                                backgroundColor: [
                                    'rgba(76, 175, 80, 0.6)',
                                    'rgba(76, 175, 80, 0.6)',
                                    'rgba(76, 175, 80, 0.6)',
                                    'rgba(76, 175, 80, 0.6)',
                                    'rgba(76, 175, 80, 0.6)'
                                ],
                                borderColor: [
                                    'rgba(76, 175, 80, 1)',
                                    'rgba(76, 175, 80, 1)',
                                    'rgba(76, 175, 80, 1)',
                                    'rgba(76, 175, 80, 1)',
                                    'rgba(76, 175, 80, 1)'
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    max: 100,
                                    ticks: {
                                        callback: function(value) {
                                            return value + '%';
                                        }
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    display: false
                                }
                            }
                        }
                    });
                }
                
                // Create factor impact bars
                const factorImpactContainer = document.getElementById('factorImpactBars');
                if (factorImpactContainer && isPositive) {
                    const factors = [
                        { name: 'Smoking History', value: 85 },
                        { name: 'Age Factor', value: 65 },
                        { name: 'Family History', value: 45 },
                        { name: 'Chronic Diseases', value: 35 },
                        { name: 'Environmental Exposure', value: 25 }
                    ];
                    
                    factors.forEach(factor => {
                        const barContainer = document.createElement('div');
                        barContainer.className = 'factor-bar';
                        
                        const barFill = document.createElement('div');
                        barFill.className = 'factor-bar-fill';
                        barFill.style.width = '0%';
                        
                        const label = document.createElement('div');
                        label.className = 'factor-label';
                        label.textContent = factor.name;
                        
                        const value = document.createElement('div');
                        value.className = 'factor-value';
                        value.textContent = factor.value + '%';
                        
                        barContainer.appendChild(barFill);
                        barContainer.appendChild(label);
                        barContainer.appendChild(value);
                        factorImpactContainer.appendChild(barContainer);
                        
                        // Animate bar fill
                        setTimeout(() => {
                            barFill.style.width = factor.value + '%';
                        }, 300);
                    });
                }
            }
            
            // Add hover effect to data table rows
            const tableRows = document.querySelectorAll('.data-table tbody tr');
            tableRows.forEach(row => {
                row.addEventListener('mouseenter', () => {
                    row.style.transition = 'background-color 0.3s ease';
                });
            });
            
            // Add hover effect to advice cards
            const adviceCards = document.querySelectorAll('.advice-card');
            adviceCards.forEach(card => {
                card.addEventListener('mouseenter', () => {
                    card.style.transition = 'transform 0.3s ease, box-shadow 0.3s ease';
                });
            });
        });
    </script>
</body>
</html>